{% load static %}
<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="generator" content="Mobirise v5.9.8, mobirise.com">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
    <meta name="description" content="">

    <title>Room Details</title>

    {% include "snippets/styles.html" %}
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="preload"
        href="https://fonts.googleapis.com/css?family=Cormorant:300,400,500,600,700,300i,400i,500i,600i,700i&display=swap"
        as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript>
        <link rel="stylesheet"
            href="https://fonts.googleapis.com/css?family=Cormorant:300,400,500,600,700,300i,400i,500i,600i,700i&display=swap">
        </noscript>
    <link rel="preload"
        href="https://fonts.googleapis.com/css?family=Josefin+Sans:100,200,300,400,500,600,700,100i,200i,300i,400i,500i,600i,700i&display=swap"
        as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript>
        <link rel="stylesheet"
            href="https://fonts.googleapis.com/css?family=Josefin+Sans:100,200,300,400,500,600,700,100i,200i,300i,400i,500i,600i,700i&display=swap">
        </noscript>

</head>

<body>
    <section data-bs-version="5.1" class="menu menu2 cid-tQVbQmzwJx" once="menu" id="menu2-j">

        <nav class="navbar navbar-dropdown navbar-fixed-top navbar-expand-lg">
            <div class="container">
                <div class="navbar-brand">
                    <span class="navbar-caption-wrap"><a class="navbar-caption text-white text-primary display-5"
                            href="index.html">SIMPARIS</a></span>
                </div>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-bs-toggle="collapse"
                    data-target="#navbarSupportedContent" data-bs-target="#navbarSupportedContent"
                    aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                    <div class="hamburger">
                        <span></span>
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav nav-dropdown" data-app-modern-menu="true">
                        <li class="nav-item"><a class="nav-link link text-white text-primary display-4"
                                href="index.html">HOME</a></li>
                        <li class="nav-item"><a class="nav-link link text-white text-primary display-4"
                                href="page1.html">ROOMS</a></li>
                        <li class="nav-item"><a class="nav-link link text-white text-primary display-4"
                                href="index.html#content4-6">ABOUT US</a></li>
                        <li class="nav-item"><a class="nav-link link text-white text-primary display-4"
                                href="#">ACTIVITIES</a></li>
                    </ul>

                    <div class="navbar-buttons mbr-section-btn"><a class="btn btn-primary display-4" href="index.html#content5-3">BOOK NOW</a></div>
                </div>
            </div>
        </nav>
    </section>

    <section data-bs-version="5.1" class="slider1 cid-tXLelc0kDz mbr-fullscreen" id="slider1-p">
        <div class="carousel slide carousel-fade" id="u0i21AXgFZ" data-ride="carousel" data-bs-ride="carousel"
            data-interval="5000" data-bs-interval="5000">
            <ol class="carousel-indicators">
                <li data-slide-to="0" data-bs-slide-to="0" class="active" data-target="#u0i21AXgFZ"
                    data-bs-target="#u0i21AXgFZ"></li>
                <li data-slide-to="1" data-bs-slide-to="1" data-target="#u0i21AXgFZ" data-bs-target="#u0i21AXgFZ"></li>
                <li data-slide-to="2" data-bs-slide-to="2" data-target="#u0i21AXgFZ" data-bs-target="#u0i21AXgFZ"></li>
            </ol>
            <div class="carousel-inner">
                <div class="carousel-item slider-image item active">
                    <div class="item-wrapper">
                        <img class="d-block w-100" src="{%static '/images/r1-1024x683.jpg'%}"alt="Mobirise Website Builder">
                    </div>
                </div>
                <div class="carousel-item slider-image item">
                    <div class="item-wrapper">
                        <img class="d-block w-100" src="{%static '/images/r1-1-1024x683.jpg'%}" alt="Mobirise Website Builder">
                    </div>
                </div>
                <div class="carousel-item slider-image item">
                    <div class="item-wrapper">
                        <img class="d-block w-100" src="{%static '/images/r2-1024x683.jpg'%}" alt="Mobirise Website Builder">
                    </div>
                </div>
            </div>
            <a class="carousel-control carousel-control-prev" role="button" data-slide="prev" data-bs-slide="prev"
                href="#u0i21AXgFZ">
                <span class="mobi-mbri mobi-mbri-arrow-prev" aria-hidden="true"></span>
                <span class="sr-only visually-hidden">Previous</span>
            </a>
            <a class="carousel-control carousel-control-next" role="button" data-slide="next" data-bs-slide="next"
                href="#u0i21AXgFZ">
                <span class="mobi-mbri mobi-mbri-arrow-next" aria-hidden="true"></span>
                <span class="sr-only visually-hidden">Next</span>
            </a>
        </div>
    </section>

    <!-- Nama Ruangan & Luas -->
    <section data-bs-version="5.1" class="content5 cid-tXLfRGBufd" id="content5-q">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-12 col-lg-10">
                    <!-- <h4></h4> -->
                    <h4 class="mbr-section-subtitle mbr-fonts-style mb-2 display-2"><strong>{{ruangan.namaRuangan}}</strong></h4>
                    <p class="mbr-text mbr-fonts-style display-7 mb-4">
                        {{ruangan.luasRuangan}} meter persegi
                    </p>
                </div>
            </div>
        </div>
    </section>
    <!-- End Nama Ruangan & Luas -->

    <section data-bs-version="5.1" class="content6 cid-tXLhqiyOEU" id="content6-s">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-12 col-lg-10">
                    <p class="mbr-text mbr-fonts-style display-7">
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam odio lorem, iaculis non felis
                        vel, faucibus efficitur dui. Aliquam erat volutpat. Quisque hendrerit massa nec lobortis mollis.
                        Nunc eu eros efficitur, convallis enim ac, ultricies nisi. Lorem ipsum dolor sit amet,
                        consectetur adipiscing. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam odio
                        lorem, iaculis non felis vel, faucibus efficitur dui. Aliquam erat volutpat. Quisque hendrerit
                        massa nec lobortis mollis. Nunc eu eros efficitur, convallis enim ac, ultricies nisi. Lorem
                        ipsum dolor sit amet, consectetur adipiscing.<br></p>
                    <hr class="line">
                </div>
            </div>
        </div>
    </section>

    <!-- Fasilitas -->
    <section data-bs-version="5.1" class="content5 cid-tXLimvYp7R" id="content5-t">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-12 col-lg-10">
                    <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5"><strong>
                            Amenities
                        </strong></h4>
                        {% for fasilitasResult in listFasilitas %}
                        <li class="mbr-text mbr-fonts-style display-7"> 
                            {{fasilitasResult.ruanganfasilitas__jumlahBarang}} {{ fasilitasResult.namaFasilitas }}
                        </li>
                        {% endfor %}    
                    <hr class="line">
                </div>
            </div>
        </div>
    </section>
    <!-- End Fasilitas -->

    <section data-bs-version="5.1" class="form5 cid-tYpCLYdsaZ" id="form5-w">
        <div class="container">
            <div class="mbr-section-head">
                <h3 class="mbr-section-title mbr-fonts-style align-center mb-0 display-2">
                    <strong>Book Now</strong></h3>
            </div>
            <div class="row justify-content-center mt-4">
                <div class="col-lg-8 mx-auto mbr-form" data-form-type="formoid">
                    <form id="checkAvailabilityForm" method="POST" action="">
                        {% csrf_token %}
                        <!-- Form  -->
                        <div class="dragArea row">
                            <div class="col-md col-sm-12 form-group mb-3" data-for="name">
                                <h4>Check-In</h4>
                                <input type="date" name="checkIn" placeholder="checkIn" data-form-field="checkIn"
                                    class="form-control" id="name-form5-w" required>
                            </div>
                            <div class="col-md col-sm-12 form-group mb-3" data-for="email">
                                <h4>Check-Out</h4>
                                <input type="date" name="checkOut" placeholder="checkIn" data-form-field="checkOut"
                                    class="form-control" id="name-form5-w" required>
                            </div>
                            <input type="hidden" name="idRuangan" id="idRuangan" value="{{ruangan.idRuangan}}">
                            <input type="hidden" name="check_availability" value="check_availability">
                            <div class="col-lg-12 col-md-12 col-sm-12 align-center mbr-section-btn"><button
                                    type="submit" class="btn btn-primary display-4">CHECK AVAILABILITY</button></div>
                        </div>
                        <!-- End Form -->
                    </form>
                    <!-- Modal -->
                    <div class="modal" id="myModal">
                        <div class="modal-dialog modal-dialog-scrollable">
                            <div class="modal-content">
                    
                                <!-- Modal Header -->
                                <div class="modal-header">
                                    <h4 class="modal-title">Status Reservasi</h4>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                    
                                <!-- Modal Body -->
                                <div class="modal-body">
                                    <div class="pesan"></div>
                                    <!-- Pesan akan ditampilkan di sini -->
                                    
                                </div>
                    
                                <!-- Modal Footer -->
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-danger" data-dismiss="modal">Tutup</button>
                                </div>
                    
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </section>

    <section data-bs-version="5.1" class="map2 cid-tYpD1fdPfk" id="map2-x">
        <div>
            <div class="mbr-section-head mb-4">
                <h3 class="mbr-section-title mbr-fonts-style align-center mb-0 display-2">
                    <strong>Map</strong>
                </h3>

            </div>
            <div class="google-map"><iframe frameborder="0" style="border:0"src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3942.8527291037726!2d115.15971477501627!3d-8.799903491252605!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x2dd244c13ee9d753%3A0x6c05042449b50f81!2sPoliteknik%20Negeri%20Bali!5e0!3m2!1sid!2sid!4v1702553592308!5m2!1sid!2sid"allowfullscreen=""></iframe></div>
        </div>
    </section>

    <section data-bs-version="5.1" class="footer7 cid-tXKXVnLDcD" once="footers" id="footer7-k">
        <div class="container">
            <div class="media-container-row align-center mbr-white">
                <div class="col-12">
                    <p class="mbr-text mb-0 mbr-fonts-style display-7">
                        © Copyright 2024 Simparis - All Rights Reserved
                    </p>
                </div>
            </div>
        </div>
    </section>

</body>

<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.9.2/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>


{% include "snippets/styles.html" %}

<script>
    $(document).ready(function() {
        // Fungsi untuk menampilkan modal dengan pesan
        var csrf_token = $('input[name=csrfmiddlewaretoken]').val();
        // function showModal(message) {
        //     $('#myModal .modal-body').text(message);
        //     $('#myModal').modal('show');
        // }

        function showModal(message) {
            var modalBody = $('#myModal .modal-body');
            if (message.success === true) {
                // Jika message true, tambahkan form ke dalam modalBody
                var form = `
                    <p>${message.message}</p>
                    <form id="completeReservation" method="POST" action="">
                        {% csrf_token %}
                        <div class="col-md col-sm-12 form-group mb-3" data-for="namaPelanggan">
                            <h4>Nama Pelanggan</h4>
                            <input type="text" name="namaPelanggan" placeholder="Nama Pelanggan" data-form-field="namaPelanggan"
                                class="form-control" id="name-form5-w" required>
                        </div>
                        <div class="col-md col-sm-12 form-group mb-3" data-for="email">
                            <h4>Email</h4>
                            <input type="email" name="email" placeholder="Email" data-form-field="email"
                                class="form-control" id="name-form5-w" required>
                        </div>
                        <div class="col-md col-sm-12 form-group mb-3" data-for="checkIn">
                            <h4>Check In</h4>
                            <input type="date" name="checkIn" placeholder="Check In" data-form-field="checkIn"
                                class="form-control" id="name-form5-w" value="${message.checkIn}" required readonly>
                        </div>
                        <div class="col-md col-sm-12 form-group mb-3" data-for="checkOut">
                            <h4>Check Out</h4>
                            <input type="date" name="checkOut" placeholder="Check In" data-form-field="checkOut"
                                class="form-control" id="name-form5-w" value="${message.checkOut}" required readonly>
                        </div>
                        <div class="col-md col-sm-12 form-group mb-3" data-for="total">
                            <h4>Total Harga</h4>
                            <input type="text" name="total" placeholder="total" data-form-field="total"
                                class="form-control" id="name-form5-w" value="${message.total}" required readonly>
                        </div>
                        <input type="hidden" name="complete_reservation" value="complete_reservation">
                        <input type="hidden" name="idRuangan" id="idRuangan" value="${message.idRuangan}">

                        <div class="col-lg-12 col-md-12 col-sm-12 align-center mbr-section-btn"><button
                            type="submit" class="btn btn-primary display-4">Book Now</button></div>
                    </form>`

                modalBody.html(form);

                // Fungsi untuk menangani pengiriman formulir
                $('#completeReservation').submit(function(event) {
                    event.preventDefault();

                    // Mengirim permintaan AJAX ke server
                    $.ajax({
                        url: '',
                        type: 'POST',
                        data: $(this).serialize(),
                        dataType: 'json',
                        headers: {
                            'X-CSRFToken': csrf_token
                        },
                        success: function(data) {
                            // Menampilkan pesan dari server dalam modal
                            showModal1(data);
                        },
                        error: function(error) {
                            // Menampilkan pesan kesalahan dalam modal
                            showModal1(error.responseJSON.error);
                        }
                    });
                });
            } else {
                // Jika message false, tampilkan pesan dalam modalBody
                modalBody.text(message.message);
            }

            // Tampilkan modal
            $('#myModal').modal('show');
        }

        function showModal1(message) {
            var modalBody = $('#myModal .modal-body');
            if (message.success === true) {
                modalBody.text(message.message);
            } else {
                // Jika message false, tampilkan pesan dalam modalBody
                modalBody.text(message.message);
            }

            // Tampilkan modal
            $('#myModal').modal('show');
        }

        // Fungsi untuk menangani pengiriman formulir
        $('#checkAvailabilityForm').submit(function(event) {
            event.preventDefault();

            // Mengirim permintaan AJAX ke server
            $.ajax({
                url: '',
                type: 'POST',
                data: $(this).serialize(),
                dataType: 'json',
                headers: {
                  'X-CSRFToken': csrf_token
                },
                success: function(data) {
                    // Menampilkan pesan dari server dalam modal
                    showModal(data);
                },
                error: function(error) {
                    // Menampilkan pesan kesalahan dalam modal
                    showModal(error.responseJSON.error);
                }
            });
        });
    });
</script>

</html>